<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>ç½‘ç»œçŠ¯ç½ªå…¨æµç¨‹æ™ºèƒ½å®£ä¼ æ•™è‚²ä¸è¾…åˆ¤ç³»ç»Ÿ</title>
</head>
<style>
    /* æé—®å¼•å¯¼åŒºåŸŸ */
    .question-guide {
        padding: 30px;
        text-align: center;
    }

    .question-guide p {
        color: #070606;
        margin-bottom: 15px;
    }

    .question-example {
        display: flex;
        justify-content: space-between;
        margin-bottom: 40px;
        gap: 30px;
    }

    .example-item {
        background-color: #efe8f9;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1), 0 0 5px rgba(0, 0, 0, 0.1);
        width: 25%;
        height: 180px;
        display: flex;
        flex-direction: column;
        position: relative;
        transition: box-shadow 0.3s ease;
    }

    .example-item:hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15), 0 0 5px rgba(0, 0, 0, 0.1);
    }

    .example-item p {
        margin-bottom: 10px;
        flex-grow: 1;
        font-size: 20px;
    }

    .try-btn {
        background-color: #ffd4c4;
        color: #333;
        text-decoration: none;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 16px;
        align-self: flex-end;
        margin-top: auto;
        transition: all 0.3s ease;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .try-btn:hover {
        background-color: #ffc5ad;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .service-intro {
        background-color: #ffd4c4;
        color: #333;
        padding: 8px 15px;
        border-radius: 20px;
        display: inline-block;
        width: 40%;
        margin: 0 auto 0px;
    }

    /* é—®é¢˜è¾“å…¥ä¸å‘é€åŒºåŸŸ */
    .question-input-area {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 30px;
        position: relative;
        width: 80%;
        margin-left: auto;
        margin-right: auto;
    }

    .question-input-area textarea {
        width: 100%;
        height: 240px;
        padding: 15px;
        border: 2px solid #333;
        border-radius: 10px;
        font-size: 16px;
        padding-right: 80px;
        box-sizing: border-box;
    }

    .send-btn {
        background-color: #ffd4c4;
        color: #0f0f0f;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 16px;
        position: absolute;
        right: 15px;
        bottom: 15px;
        cursor: pointer;
    }

    /* å›ç­”åŒºåŸŸæ ·å¼ */
    .answer-container {
        width: 80%;
        margin: 0 auto 30px;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background-color: #f9f9f9;
    }

    .download-btn {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        font-size: 16px;
        cursor: pointer;
        margin-top: 15px;
        display: block;
        width: 200px;
        text-align: center;
        margin: 15px auto 0;
    }

    .download-btn:hover {
        background-color: #45a049;
    }
</style>

<body>
    <!-- é¡¶éƒ¨çº¢è‰²æ¨ªå¹… -->
    <div class="top-banner">
        ç¡®ä¿äº’è”ç½‘åœ¨æ³•æ²»è½¨é“ä¸Šå¥åº·è¿è¡Œ
    </div>
    <!-- ç³»ç»Ÿåç§°åŒºåŸŸ -->
    <div class="title-container">
        <div class="title-left">
            <img src="img/img2(1).png" alt="ç³»ç»Ÿæ ‡å¿—" class="title-logo">
            <div class="system-title">å¸®ä¿¡ç½ªå…¨æµç¨‹æ™ºèƒ½å®£ä¼ æ•™è‚²ä¸è¾…åˆ¤ç³»ç»Ÿ</div>
        </div>
        <div class="search-box">
            <input type="text" class="search-input" placeholder="æœç´¢...">
            <div class="search-icon">ğŸ”</div>
            <a href="login.html" class="login-btn">ç™»å½•</a>
            <a href="login.html" id="logout-btn" style="display: none;">é€€å‡º</a>
        </div>
    </div>
    <!-- å¯¼èˆªæ  -->
    <div class="nav-container">
        <div class="nav-menu">
            <a href="index.html" class="nav-item">é¦–é¡µ</a>
            <a href="system.html" class="nav-item">ç³»ç»Ÿæ¦‚å†µ</a>
            <a href="crime-intro.html" class="nav-item">ç½ªåä»‹ç»</a>
            <a href="cases.html" class="nav-item">å…¸å‹æ¡ˆä¾‹</a>
            <a href="news.html" class="nav-item">çƒ­ç‚¹æ–°é—»</a>
        </div>
    </div>
    <!-- æé—®å¼•å¯¼åŒºåŸŸ -->
    <div class="question-guide">
        <p>æ‚¨å¯ä»¥è¿™æ ·é—®æˆ‘ï¼š</p>
        <div class="question-example">
            <div class="example-item">
                <p>å¸®ä¿¡ç½ªçš„å…¥ç½ªæ ‡å‡†ï¼Ÿ</p>
                <a href="#" class="try-btn">å»è¯•è¯•</a>
            </div>
            <div class="example-item">
                <p>å“ªäº›è¡Œä¸ºå¯èƒ½æ„æˆå¸®ä¿¡ç½ªï¼Ÿ</p>
                <a href="#" class="try-btn">å»è¯•è¯•</a>
            </div>
            <div class="example-item">
                <p>å¸®ä¿¡ç½ªçš„é‡åˆ‘æ ‡å‡†ï¼Ÿ</p>
                <a href="#" class="try-btn">å»è¯•è¯•</a>
            </div>
        </div>
        <div class="service-intro">æä¾›åœ¨çº¿æ³•å¾‹å’¨è¯¢æœåŠ¡ï¼Œé’ˆå¯¹æ€§è§£ç­”å…³äºç½‘ç»œçŠ¯ç½ªçš„ç–‘æƒ‘</div>
    </div>
    <!-- é—®é¢˜è¾“å…¥ä¸å‘é€åŒºåŸŸ -->
    <div class="question-input-area">
        <textarea id="question-input" placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜"></textarea>
        <button id="send-btn" class="send-btn">å‘é€</button>
    </div>
    <!-- å›ç­”æ˜¾ç¤ºåŒºåŸŸ -->
    <div id="answer-container" class="answer-container" style="display: none;">
        <div id="answer-content"></div>
        <button id="download-btn" class="download-btn">ä¸‹è½½å›ç­”</button>
    </div>
    <script src="script.js"></script>
    <script>
        // è·å–æ‰€æœ‰"å»è¯•è¯•"æŒ‰é’®
        const tryBtns = document.querySelectorAll('.try-btn');
        // è·å–è¾“å…¥æ¡†
        const textarea = document.querySelector('textarea');

        tryBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                const question = this.previousElementSibling.textContent;
                textarea.value = question;
            });
        });

        // å‘é€é—®é¢˜å’Œå¤„ç†å›ç­”
        document.getElementById('send-btn').addEventListener('click', async () => {
            const question = document.getElementById('question-input').value;
            const answerContainer = document.getElementById('answer-container');
            const answerContent = document.getElementById('answer-content');
            
            if (!question) {
                alert('è¯·è¾“å…¥æ‚¨çš„é—®é¢˜');
                return;
            }

            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                answerContent.textContent = 'æ­£åœ¨è·å–ç­”æ¡ˆï¼Œè¯·ç¨å€™...';
                answerContainer.style.display = 'block';

                const response = await fetch('http://10.79.3.77:5000/answer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ question: question })
                });

                if (!response.ok) {
                    throw new Error('ç½‘ç»œå“åº”ä¸æ­£å¸¸');
                }

                const data = await response.json();
                answerContent.innerHTML = `<h3>æ‚¨çš„é—®é¢˜ï¼š</h3><p>${question}</p><h3>å›ç­”ï¼š</h3><p>${data.answer}</p>`;
                
                // è®¾ç½®ä¸‹è½½åŠŸèƒ½
                document.getElementById('download-btn').onclick = function() {
                    downloadAnswer(question, data.answer);
                };
                
            } catch (error) {
                console.error('è¯·æ±‚å‡ºé”™:', error);
                answerContent.textContent = 'è¯·æ±‚å‡ºé”™ï¼Œè¯·ç¨åå†è¯•ã€‚';
            }
        });

        // ä¸‹è½½å›ç­”ä¸ºæ–‡ä»¶
        function downloadAnswer(question, answer) {
            const content = `é—®é¢˜ï¼š${question}\n\nå›ç­”ï¼š${answer}\n\n---\næ¥è‡ªï¼šç½‘ç»œçŠ¯ç½ªå…¨æµç¨‹æ™ºèƒ½å®£ä¼ æ•™è‚²ä¸è¾…åˆ¤ç³»ç»Ÿ\næ—¶é—´ï¼š${new Date().toLocaleString()}`;
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `æ³•å¾‹å’¨è¯¢å›ç­”_${new Date().toISOString().slice(0, 10)}.txt`;
            document.body.appendChild(a);
            a.click();
            
            // æ¸…ç†
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
    </script>

<script src="auth.js"></script>
</body>

</html>